##加权基因共表达网络(WGCNA)描述
加权基因共表达网络构建(Weighted Gene Co-Expression Network Analysis, WGCNA)是一种从高通量数据中挖掘模块(module)信息的算法。在该方法中module被定义为一组具有类似表达谱的基因，如果某些基因在一个<b>生理过程或不同组织中</b>总是具有相类似的表达变化，那么我们有理由认为这些基因在功能上是相关的，可以把他们定义为一个模块(module)。

1 原理

在共表达网络中，每一个基因在一个特定时间或空间的表达情况被视做一个点(node)，为了得到基因间的关联情况，我们需要计算任何两个基因间的相关系数(Person Coefficient)，第i个基因和第j个基因的Person Coefficient，即两个基因的表达相似性。为了知道两个基因的表达谱是否具有相似性，需要人为规定一个阈值，只有当基因间的Person Coefficient达到这一阈值后(如0.8)我们才认为这两个基因是相似的，否则则不相似。但是这种分析方法存在一个很明显的局限，即我们没有理由认为Person Coefficient为0.8的两个基因与Coefficient为0.79的两个基因是有显著差别的，但是以上算法却无法避免这一处境，WGCNA采用了一种基于软阈值的判定方法很好地避免了这一问题。

网络的数学名称是图，在图论中对于每一个节点有一个重要概念，即：度。一个点的度是指图中该点所关联的边数。无尺度网路具有这样的特点，即存在少数节点具有明显高于一般点的度，这些点被称为hub。由少数hub与其它节点关联，最终构成整个网络。这样的网络的节点度数与具有该度数的节点个数间服从power distribution。这为我们寻找最佳参数提供了理论依据。生物体选择scale-free network而不是random network是有它进化上的原因的，显然对于scale-free network，少数关键基因执行着主要功能，只要保证hub的完整性，整个生命体系的基本活动在一定刺激影响下将不会受到太大影响。

计算完相关系数之后理论上可以将基因按照表达模式进行分类，将模式相似的基因归为一个模块。这样做有什么好处呢？ 上文中我们提到理论上表达模式相似的基因可能就会参与相似的通路，或有相似的功能。通过这样的分类，信息量就被简化了。原来是成千上万个基因，现在被分成了几十个模块。下图就是将基因分为不同模块的结果图，每种颜色都代表一个模块。

研究策略

   
    功能富集

   各个模块都进行 KEGG、GO等功能富集分析，找出与我们研究性状（比方说光合作用或形态建成等等）相关通路相关性最强的模块进行深入挖掘。

    性状之间的相关性

   模块的本质上就是一群表达模式相似的基因的大集合。我们可以利用数学的方法，算出这群基因表达量的综合值来代表这个模块，将这个值叫做“模块特征值”。也可以这么理解，每个模块就是一个 “超级基因”，它的表达量是所有成员共同作用的结果。假设最初测序的样本是50只体重各异的小鼠， 而现在分析后得到30个“超级基因”，那么到底哪个“超级基因”值得我们后续研究呢？ 答案很简单，计算这些超级基因与体重之间的关系，找到相关性高的那个“超级基因”就是我们后续要重点研究的模块。

    模块与样本间的相关系数 
    
    功能与应用

基因共表达网络分析（Gene Co-expression Network Analysis）是根据基因表达信号值的动态变化，计算基因间的共表达关系，来建立基因转录调控模型，得到基因间的表达调控关系及调控方向，从而寻找一个或多个物种在不同发育阶段，或者不同组织在不同条件或处理下的全部基因表达调控网络模型以及关键基因，从而系统的研究生物体复杂的生命现象。

    寻找核心基因（上文提到的hub）

模块中的各基因成员在关系上并非是平等的。我们把处于调控网络中心的基因称为核心基因（hub gene），这类基因通常是转录因子等关键的调控因子，是值得我们优先深入分析和挖掘的对象。而周边那些打酱油的成员，优先级可以往后放一放；

    预测基因功能 
在网络中，被调控线连接的基因，其表达模式是相似的，我们可以认为它们有相似的功能。所以，在这个网络中，如果线条一端的基因功能是已知的，那么就可以预测线条另一端功能未知的基因也有相似的功能，这就为我们下一步功能验证未知基因打开了一扇窗户。

##


WGCNA用起来也没那么难，今天给大家分享一下新手学习WGCNA的经验、常见问题的解决办法，以及如何理解WGCNA分析流程中的关键点，以达到应用的目的。让大家能够入门WGCNA进行实操是我整理这一学习笔记的最终目的。笔记内容涉及到WGCNA的简介，安装运行，代码解析和灵活变换，跑出的图有什么意义等，准备分3-4次说。


WGCNA能够从复杂数据中（N多分组）快速地提取出与样本特征相关的基因共表达模块，以供后续分析。简单地说，它通过计算<b>基因之间的表达相关性</b>，将具有表达相关性的基因聚类到一个模块中，然后再分析模块与样本特征（包括临床特征、手术方式、治疗方法等等）之间的相关性，WGCNA搭建了一座样本特征与基因表达变化之间的桥梁。

<b>这张图是根据你样本中基因表达情况，将共表达的基因聚类到一个个彩色的模块当中，其中灰色模块是没有被接受的基因，后续分析中这一模块的基因就没有什么用了。</b>


